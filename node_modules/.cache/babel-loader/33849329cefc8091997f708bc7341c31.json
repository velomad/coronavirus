{"ast":null,"code":"import { STATE_CODES } from './constants';\nimport moment from 'moment';\nconst months = {\n  '01': 'Jan',\n  '02': 'Feb',\n  '03': 'Mar',\n  '04': 'Apr',\n  '05': 'May',\n  '06': 'Jun',\n  '07': 'Jul',\n  '08': 'Aug',\n  '09': 'Sep',\n  '10': 'Oct',\n  '11': 'Nov',\n  '12': 'Dec'\n};\nexport const getStateName = code => {\n  return STATE_CODES[code.toUpperCase()];\n};\nexport const formatDate = unformattedDate => {\n  const day = unformattedDate.slice(0, 2);\n  const month = unformattedDate.slice(3, 5);\n  const year = unformattedDate.slice(6, 10);\n  const time = unformattedDate.slice(11);\n  return `${year}-${month}-${day}T${time}+05:30`;\n};\nexport const formatDateAbsolute = unformattedDate => {\n  const day = unformattedDate.slice(0, 2);\n  const month = unformattedDate.slice(3, 5);\n  const time = unformattedDate.slice(11);\n  return `${day} ${months[month]}, ${time.slice(0, 5)} IST`;\n};\n\nconst validateCTS = (data = []) => {\n  const today = new Date();\n  today.setHours(0, 0, 0, 0);\n  const dataTypes = ['dailyconfirmed', 'dailydeceased', 'dailyrecovered', 'totalconfirmed', 'totaldeceased', 'totalrecovered'];\n  return data.filter(d => dataTypes.every(dt => d[dt]) && d.date).filter(d => dataTypes.every(dt => Number(d[dt]) >= 0)).filter(d => {\n    const year = today.getFullYear();\n    return new Date(d.date + year) < today;\n  });\n};\n\nexport const preprocessTimeseries = timeseries => {\n  return validateCTS(timeseries).map((stat, index) => ({\n    date: new Date(stat.date + ' 2020'),\n    totalconfirmed: +stat.totalconfirmed,\n    totalrecovered: +stat.totalrecovered,\n    totaldeceased: +stat.totaldeceased,\n    dailyconfirmed: +stat.dailyconfirmed,\n    dailyrecovered: +stat.dailyrecovered,\n    dailydeceased: +stat.dailydeceased,\n    // Active = Confimed - Recovered - Deceased\n    totalactive: +stat.totalconfirmed - +stat.totalrecovered - +stat.totaldeceased,\n    dailyactive: +stat.dailyconfirmed - +stat.dailyrecovered - +stat.dailydeceased\n  }));\n};\n/**\r\n * Returns the last `days` entries\r\n * @param {Array<Object>} timeseries\r\n * @param {number} days\r\n *\r\n * @return {Array<Object>}\r\n */\n\nexport function sliceTimeseriesFromEnd(timeseries, days) {\n  return timeseries.slice(-days);\n}\nexport const formatNumber = value => {\n  const numberFormatter = new Intl.NumberFormat('en-IN');\n  return isNaN(value) ? '-' : numberFormatter.format(value);\n};\nexport const parseStateTimeseries = ({\n  states_daily: data\n}) => {\n  const statewiseSeries = Object.keys(STATE_CODES).reduce((a, c) => {\n    a[c] = [];\n    return a;\n  }, {});\n  const today = moment();\n\n  for (let i = 0; i < data.length; i += 3) {\n    const date = moment(data[i].date, 'DD-MMM-YY'); // Skip data from the current day\n\n    if (date.isBefore(today, 'Date')) {\n      Object.entries(statewiseSeries).forEach(([k, v]) => {\n        const stateCode = k.toLowerCase();\n        const prev = v[v.length - 1] || {}; // Parser\n\n        const dailyconfirmed = +data[i][stateCode] || 0;\n        const dailyrecovered = +data[i + 1][stateCode] || 0;\n        const dailydeceased = +data[i + 2][stateCode] || 0;\n        const totalconfirmed = +data[i][stateCode] + (prev.totalconfirmed || 0);\n        const totalrecovered = +data[i + 1][stateCode] + (prev.totalrecovered || 0);\n        const totaldeceased = +data[i + 2][stateCode] + (prev.totaldeceased || 0); // Push\n\n        v.push({\n          date: date.toDate(),\n          dailyconfirmed: dailyconfirmed,\n          dailyrecovered: dailyrecovered,\n          dailydeceased: dailydeceased,\n          totalconfirmed: totalconfirmed,\n          totalrecovered: totalrecovered,\n          totaldeceased: totaldeceased,\n          // Active = Confimed - Recovered - Deceased\n          totalactive: totalconfirmed - totalrecovered - totaldeceased,\n          dailyactive: dailyconfirmed - dailyrecovered - dailydeceased\n        });\n      });\n    }\n  }\n\n  return statewiseSeries;\n};","map":{"version":3,"sources":["D:/Users/sagar/Desktop/projects/React projects/coronavirus/src/utils/commonFunctions.js"],"names":["STATE_CODES","moment","months","getStateName","code","toUpperCase","formatDate","unformattedDate","day","slice","month","year","time","formatDateAbsolute","validateCTS","data","today","Date","setHours","dataTypes","filter","d","every","dt","date","Number","getFullYear","preprocessTimeseries","timeseries","map","stat","index","totalconfirmed","totalrecovered","totaldeceased","dailyconfirmed","dailyrecovered","dailydeceased","totalactive","dailyactive","sliceTimeseriesFromEnd","days","formatNumber","value","numberFormatter","Intl","NumberFormat","isNaN","format","parseStateTimeseries","states_daily","statewiseSeries","Object","keys","reduce","a","c","i","length","isBefore","entries","forEach","k","v","stateCode","toLowerCase","prev","push","toDate"],"mappings":"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","sourcesContent":["import {STATE_CODES} from './constants';\r\n\r\nimport moment from 'moment';\r\n\r\nconst months = {\r\n  '01': 'Jan',\r\n  '02': 'Feb',\r\n  '03': 'Mar',\r\n  '04': 'Apr',\r\n  '05': 'May',\r\n  '06': 'Jun',\r\n  '07': 'Jul',\r\n  '08': 'Aug',\r\n  '09': 'Sep',\r\n  '10': 'Oct',\r\n  '11': 'Nov',\r\n  '12': 'Dec',\r\n};\r\n\r\nexport const getStateName = (code) => {\r\n  return STATE_CODES[code.toUpperCase()];\r\n};\r\n\r\nexport const formatDate = (unformattedDate) => {\r\n  const day = unformattedDate.slice(0, 2);\r\n  const month = unformattedDate.slice(3, 5);\r\n  const year = unformattedDate.slice(6, 10);\r\n  const time = unformattedDate.slice(11);\r\n  return `${year}-${month}-${day}T${time}+05:30`;\r\n};\r\n\r\nexport const formatDateAbsolute = (unformattedDate) => {\r\n  const day = unformattedDate.slice(0, 2);\r\n  const month = unformattedDate.slice(3, 5);\r\n  const time = unformattedDate.slice(11);\r\n  return `${day} ${months[month]}, ${time.slice(0, 5)} IST`;\r\n};\r\n\r\nconst validateCTS = (data = []) => {\r\n  const today = new Date();\r\n  today.setHours(0, 0, 0, 0);\r\n  const dataTypes = [\r\n    'dailyconfirmed',\r\n    'dailydeceased',\r\n    'dailyrecovered',\r\n    'totalconfirmed',\r\n    'totaldeceased',\r\n    'totalrecovered',\r\n  ];\r\n  return data\r\n    .filter((d) => dataTypes.every((dt) => d[dt]) && d.date)\r\n    .filter((d) => dataTypes.every((dt) => Number(d[dt]) >= 0))\r\n    .filter((d) => {\r\n      const year = today.getFullYear();\r\n      return new Date(d.date + year) < today;\r\n    });\r\n};\r\n\r\nexport const preprocessTimeseries = (timeseries) => {\r\n  return validateCTS(timeseries).map((stat, index) => ({\r\n    date: new Date(stat.date + ' 2020'),\r\n    totalconfirmed: +stat.totalconfirmed,\r\n    totalrecovered: +stat.totalrecovered,\r\n    totaldeceased: +stat.totaldeceased,\r\n    dailyconfirmed: +stat.dailyconfirmed,\r\n    dailyrecovered: +stat.dailyrecovered,\r\n    dailydeceased: +stat.dailydeceased,\r\n    // Active = Confimed - Recovered - Deceased\r\n    totalactive:\r\n      +stat.totalconfirmed - +stat.totalrecovered - +stat.totaldeceased,\r\n    dailyactive:\r\n      +stat.dailyconfirmed - +stat.dailyrecovered - +stat.dailydeceased,\r\n  }));\r\n};\r\n\r\n/**\r\n * Returns the last `days` entries\r\n * @param {Array<Object>} timeseries\r\n * @param {number} days\r\n *\r\n * @return {Array<Object>}\r\n */\r\nexport function sliceTimeseriesFromEnd(timeseries, days) {\r\n  return timeseries.slice(-days);\r\n}\r\n\r\nexport const formatNumber = (value) => {\r\n  const numberFormatter = new Intl.NumberFormat('en-IN');\r\n  return isNaN(value) ? '-' : numberFormatter.format(value);\r\n};\r\n\r\nexport const parseStateTimeseries = ({states_daily: data}) => {\r\n  const statewiseSeries = Object.keys(STATE_CODES).reduce((a, c) => {\r\n    a[c] = [];\r\n    return a;\r\n  }, {});\r\n\r\n  const today = moment();\r\n  for (let i = 0; i < data.length; i += 3) {\r\n    const date = moment(data[i].date, 'DD-MMM-YY');\r\n    // Skip data from the current day\r\n    if (date.isBefore(today, 'Date')) {\r\n      Object.entries(statewiseSeries).forEach(([k, v]) => {\r\n        const stateCode = k.toLowerCase();\r\n        const prev = v[v.length - 1] || {};\r\n        // Parser\r\n        const dailyconfirmed = +data[i][stateCode] || 0;\r\n        const dailyrecovered = +data[i + 1][stateCode] || 0;\r\n        const dailydeceased = +data[i + 2][stateCode] || 0;\r\n        const totalconfirmed = +data[i][stateCode] + (prev.totalconfirmed || 0);\r\n        const totalrecovered =\r\n          +data[i + 1][stateCode] + (prev.totalrecovered || 0);\r\n        const totaldeceased =\r\n          +data[i + 2][stateCode] + (prev.totaldeceased || 0);\r\n        // Push\r\n        v.push({\r\n          date: date.toDate(),\r\n          dailyconfirmed: dailyconfirmed,\r\n          dailyrecovered: dailyrecovered,\r\n          dailydeceased: dailydeceased,\r\n          totalconfirmed: totalconfirmed,\r\n          totalrecovered: totalrecovered,\r\n          totaldeceased: totaldeceased,\r\n          // Active = Confimed - Recovered - Deceased\r\n          totalactive: totalconfirmed - totalrecovered - totaldeceased,\r\n          dailyactive: dailyconfirmed - dailyrecovered - dailydeceased,\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  return statewiseSeries;\r\n};\r\n"]},"metadata":{},"sourceType":"module"}